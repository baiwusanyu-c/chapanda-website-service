# chapanda-website-service 部署步骤
## 服务器初始化
直接使用宝塔镜像安装到服务器上，可以使用宝塔页面进行各种安装
### 服务器安装 git
### 服务器安装 pnpm
### 服务器安装 docker
宝塔页面安装docker

## 后端项目脚本编写
## 编写CI/CD脚本（以 github 为例）
在项目根目录下创建 `.github/workflow/deploy.yml`

## 编写 .dockerignore
在执行 `Docker` 操作时，忽略的文件内容，
我们的 `Dockerfile` 会从容器外复制项目源码到容器内，
这里可以忽略要复制的内容，尤其上 `node_modules`
```dockerignore
node_modules/
.vscode/
.git/
```

## 编写 setup.sh
在 CI/CD 中，我们链接了部署服务器，并在工作目录中拉取了代码，
此时我们需要一个脚本来启动 docker，我们使用 docker-compose 来启动多个容器，
其中包括next前端、nest后端、oss文件存储的minio、redis数据库、mysql数据库、nginx等，
这个脚本我们把它命名为 setup.sh,并存放在后端项目scripts中
```shell
#!/usr/bin/env bash
#image_version=`date +%Y%m%d%H%M`;
# 关闭容器
docker-compose stop || true;
# 删除容器
docker-compose down || true;
# 构建镜像
docker-compose build;
# 启动并后台运行
docker-compose up -d;
# 查看日志
docker logs chapanda-website-service;
# 对空间进行自动清理
docker system prune -a -f
```
## 编写 Docker-Compose
## 编写 Dockerfile
